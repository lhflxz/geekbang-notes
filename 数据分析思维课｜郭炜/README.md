# 数据分析基础

## 01 | 平均值：不要被骗了，它不能代表整体水平

整体平均值是在数据呈均匀分布或者正态分布的情况下才会有意义，如果忽略整个数据的分布情况，只提平均值，其实是没有意义的。

辛普森悖论，在分组比较中都占优势的一方，有的时候在总评中反而是失势的一方。

辛普森悖论也给我们一个启示，就是：每次小范围内的输赢，其实和你在整体上的输赢没有太大直接的关系。这也是为什么在打麻将或者打德扑真正赢的那些人，不是那些小牌把把赢的人，而往往是赢一把大的人。

这也是这个辛普森悖论衍生出来的一个推论，将来你要用数据分析做决策的时候，小到打牌、大到做投资，不要过于计较局部的得失，而是要在关键时刻对大概率有把握的事情放手一搏。

## 02 | 大数定律与小数陷阱：生活是随机还是有定数的？

大数定律是由瑞士数学家雅各布·伯努利提出来并验证的，它的核心逻辑是说当随机事件发生的次数足够多时，发生的频率才会趋近于预期的概率。

赌徒谬误，小数陷阱，每次的事件其实和上一次的事件是独立且随机的。“否极泰来”需要足够多的次数才可能出现，做事情要少一些“赌徒心态”。

“慎始敬终”。“慎始”指的是要想清楚，有没有持续投入的准备，没有想清楚就不要开始。“敬终”指的是，一旦做了，持续投入，从头到尾踏踏实实落实。

## 03 | 数据的期望值：为什么你坐的飞机总是晚点？

期望值就是对可能出现的结果以概率为权做加权平均。

墨菲定律的原理其实是由我们对于好事情和坏事情的期望值差异造成的。简单讲，印象深刻再加上担心的时候概率高，自然也就担心什么发生什么了。

## 04 | 随机对照试验：章鱼保罗真的是“预言帝”么？

## 05 | 直方图与幂分布：为什么全世界1%的人掌握着50%的财富？

直方图是展示数据的分布，而柱状图是比较数据的大小。

直方图是针对定量数据分布的定性分析，柱状图是对分类数据的定量数据分析。

幂率分布也叫做指数分布，你会发现在这种分布里，X 轴的开始的地方数值很高（或很低），然后以指数级的下降（或上升）到 X 轴的末尾段，按照统计学定义叫做：“分布密度函数是幂函数的分布”。

“帕雷托法则”（也被人称之为“二八法则”）。这个法则的背后的规律就是幂律分布。

我们耳熟能详的帕雷托法则（也就是二八法则）、马太效应都是来自幂律分布。

## 06 | 数据分布：房子应该是买贵的还是买便宜的？

大数定律和中心极限定理说的不是一个维度的事情。大数定律算的是概率，中心极限定理算的是样本和的分布。

怎样去理解这个拉普拉斯分布呢？它经常用在金融领域，尤其是衡量股票收益的时候。起初我们认为股票收益率是服从正态分布，但是由于股票价格波动与时间变化有关，有波动聚集性，最后实际股票的收益率都是符合拉普拉斯分布的，也就是赚大钱的日子其实特别集中，余下的都是赚小钱的日子。

准确把握住数据分布这个大势，我们才能够做出更为正确的决策。就拿买房这件事来说吧，买房是一个我们基本都绕不开的话题，在你买房前，你可以先判断一下你要买的房屋的房价在这座城市里是正态分布还是拉普拉斯分布。

也就是说你可以去评估一下，你所在城市资源是否比较平均？会不会出现聚集效应？如果你认真用这两个分布去判断一下，你会发现如果你所在的城市是三四线城市，那么房价的分布大概率会呈正态分布。那么在这种情况下你要投资买房就可以选择价格在曲线腰部的房子，这种房子的房价将来涨跌以及抗风险性都比较适中。

而如果你准备买大城市里的房子，情况就不一样了。因为对于一线城市的房价而言，大概率是呈拉普拉斯分布的，这也就意味着越贵的房子周边资源越好，进而这些房子将来增值空间越大。那我们买房子的时候就应该买资源最好的最贵的房子，未来的收获也最大（当然，如果最贵的已经天价了，那么我们可以退而求其次）。

反之，当你看到一些铺面房非常便宜的时候，你要留个心眼了：是不是这些铺面房处于拉普拉斯分布的最两侧？如果是，那么这些铺面房不但增值空间小，将来还有可能买了亏本的风险。所以，只有了解整体市场的分布我们才能够更好地把握市场大势，顺势而为。

<img src="assets/06 | 数据分布：房子应该是买贵的还是买便宜的？ AB测试.webp" alt="06 | 数据分布：房子应该是买贵的还是买便宜的？ AB测试" style="zoom:50%;" />

## 07 | 散点图和相关性：怎样快速从数据当中找到规律？

## 08 | 标准差：这人是不是“靠谱”其实看标准差？

## 09 | 数据抽样：大数据来了还需要抽样么？

大数据中的抽样算法

蓄水池算法

给你一个长度很大或者长度大小未知的数据（流），并且你只能访问一次该数据（流）的数据。请写出一个随机选择算法，使得选中数据流中每个数据的概率都相等。

1. 将 1~n 条数据，存入待定长为 n 的集合序列，从这个序列里随机抽取 k 条数据，每条被抽取的概率为：k/n。

2. 
   读到于第 k 条数据时：


- 定义第 k 条数据选中的概率为：k/n；
- 如果被选中，在原集合序列中的 n 条数据中随机选择一条，替换为第 k 条的新数据；
- 前 k 条数据被选取后，第 k+1 条数据要么被选取替代为前 k 条中的一条，要么不被选取，概率为 k/n。再依此规则遍历所有的数据。

整体证明这个算法是公平的过程，你可以参考知乎的[这篇文章](https://zhuanlan.zhihu.com/p/44154029)。

单机版本实现起来可以如下实现，直接调用 Sampling(k)，就可以得到蓄水池中的 k 个数据。

```
public class ReservoirSampling {
    private int[] ALL; // 整体的水池中的数据
    private final int N = 100000; // 整体数据规模
    private final int K = 1000; // 水池规模
    private Random random = new Random();
    public void setUp() throws Exception {
        ALL = new int[N];
        for (int i = 0; i < N; i++) {
            ALL[i] = i;
        }
    }
    private int[] Sampling(int K) {
        int[] Pool = new int[K];
        for (int i = 0; i < K; i++) { // 前面K个印度人直接进入水池
            Pool[i] = ALL[i];
        }
        for (int i = K; i < N; i++) { // K + 1个元素开始进行概率采样
            int r = random.nextInt(i + 1);  //这就是K/N的概率
            if (r < K) {
                Pool[r] = ALL[i]; //如果被选中了，那么这个人就被从蓄水池中挤出来，用新人进去
            }
        }
        return Pool;
    }
}
```

## 10 | 指数和KPI：智商是怎么计算出来的？

[有关数据治理的本质及实践，看这一篇就够了](https://www.infoq.cn/article/ubch5bdk2twgdo5x*uzn)

## 11 | 因果倒置：星座真的可以判定你的性格吗？

以偏概全——伯克松悖论

伯克松悖论指的是当不同个体被纳入研究样本的机会不同时，研究样本中的两个变量 X 和 Y 表现出统计相关，而总体中 X 和 Y 却不存在这种相关性。

# 数据算法基础

## 12 | 精确率与置信区间：两种预测，你究竟应该相信哪一个？
